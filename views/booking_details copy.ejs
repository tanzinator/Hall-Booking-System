<html>

<head>
    <meta charset="utf-8" />
    <title>Maruti Mandir</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="" name="description" />
    <meta content="" name="author" />

    <!-- GLOBAL MANDATORY STYLES -->
    <link href="https://fonts.googleapis.com/css?family=Hind:300,400,500,600,700" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet"
        type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.1/css/bootstrap-datepicker.min.css"
        rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"
        type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet"
        type="text/css" />
    <link href="/vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css" />

    <!-- PAGE LEVEL PLUGIN STYLES -->
    <link href="/css/animate.css" rel="stylesheet">
    <link href="/vendor/swiper/css/swiper.min.css" rel="stylesheet" type="text/css" />
    <link href="/vendor/magnific-popup/magnific-popup.css" rel="stylesheet" type="text/css" />

    <!-- THEME STYLES -->
    <link href="/css/layout.min.css" rel="stylesheet" type="text/css" />


    <!-- Favicon -->
    <link rel="shortcut icon" href="favicon.ico" />


    <style>
        .select {
            height: 50px;
        }

        #overlay {
            position: fixed;
            top: 0;
            z-index: 100;
            width: 100%;
            height: 100%;
            display: none;
            background: rgba(0, 0, 0, 0.6);
        }

        .cv-spinner {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px #ddd solid;
            border-top: 4px #2e93e6 solid;
            border-radius: 50%;
            animation: sp-anime 0.8s infinite linear;
        }

        @keyframes sp-anime {
            100% {
                transform: rotate(360deg);
            }
        }

        .is-hide {
            display: none;
        }

        .datepicker table tr td.disabled,
        .datepicker table tr td.disabled:hover {
            color: #b90000;
        }
    </style>

</head>

<body id="body" data-target=".header">
    <!--========== HEADER ==========-->

    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Maruti Mandir Hall Booking</a>
            </div>
            <div class="collapse navbar-collapse" id="navbarResponsive">

                <ul class="nav navbar-nav navbar-right">
                    <li class="nav-item active">
                        <a class="nav-link" href="/">Home
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>

                </ul>
            </div>
        </div>
    </nav>


    <!--========== END HEADER ==========-->
    <div class="promo-block">
        <div class="container">
            <div class="margin-b-20">
                <h3 class="promo-block-title">Please enter your details below</h1>
            </div>
        </div>
    </div>



    <form class="well form-horizontal" action="/submitBooking" method="POST" id="feedbackform">

        <fieldset>
            <!-- Form Name -->
            <div class="form-group">
                <label class="col-md-4 control-label">First Name</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="first_name" placeholder="First Name" class="form-control" type="text">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">Last Name</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="last_name" id="last_name" placeholder="Last name" class="form-control" type="text">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">Email Id</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="email" placeholder="Email Id" class="form-control" type="text">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">Aadhar Number</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="aadhar" placeholder="Aadhar Number" class="form-control" type="number">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">Pan Number</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="pan" placeholder="Pan Number" class="form-control" type="text">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">Billing Address</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="billing_address" placeholder="Billing Address" class="form-control" type="text">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">GSTIN(If Available)</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input name="gstin" placeholder="GSTIN" class="form-control" type="text">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div id="overlay">
                    <div class="cv-spinner">
                        1<span class="spinner"></span>
                    </div>
                </div>
                <label class="col-md-4 control-label">Date Of Booking</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group date" id="datetimepicker" data-date-format="dd.mm.yyyy"
                        data-link-field="dtp_input1">
                        <span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>
                        <input type="text" name="booking_date" id="booking_date" class="datepicker form-control"
                            placeholder="dd.mm.yyyy" readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">Occasion Type</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-file"></i></span>
                        <input name="occasion_type" id="occasion_type" placeholder="Occasion Type" class="form-control"
                            type="text">
                    </div>
                </div>
            </div>
            <%if(typeof(venues) !="undefined"){ %>
            <div class="form-group">
                <label class="col-md-4 control-label">Venue Selected</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">

                        <span class="input-group-addon"><i class="glyphicon glyphicon-file"></i></span>
                        <input name="venue_name" id="venue_name" value="<%= venues[0].venue_name%>" class="form-control"
                            type="text" readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-4 control-label">Price</label>
                <div class="col-md-4 inputGroupContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-file"></i></span>
                        <input name="price" id="price" value="<%= venues[0].venue_price%>" class="form-control"
                            type="text" readonly="readonly">
                    </div>
                </div>
            </div>
            <%}%>

            <div class="form-group ">
                <label class="col-md-4 control-label"></label>
                <div class="col-md-8" style="margin-top: 60px;">
                    <button type="submit" class="btn btn-warning" name="enquiry" id="enquiry">Submit
                        Enquiry</span></button>

                </div>
            </div>
        </fieldset>
    </form>



    <!-- Back To Top -->
    <a href="javascript:void(0);" class="js-back-to-top back-to-top">Top</a>

    <!-- JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
    <!-- CORE PLUGINS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>


    <!-- PAGE LEVEL PLUGINS -->
 
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBsXUGTFS09pLVdsYEE9YrO2y4IAncAO2U&amp;callback=initMap"
        async defer></script>

    <!-- PAGE LEVEL SCRIPTS -->
    <footer>
            <div style="text-align: center;">
                    <p>Developed by <a href="https://octointernet.com">Nishadh Amonkar</a> and Tanay Amonkar<br>
                        <a href="mailto:marutimandirdavorlim@gmail.com">Email Us</a></p>
            </div>
           
          </footer>
</body>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.1/js/bootstrap-datepicker.min.js"
    type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.full.js" type="text/javascript"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.0/css/bootstrapValidator.min.css"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-validator/0.5.3/js/bootstrapValidator.js"></script>

<script>
    jQuery(function ($) {



        var disabledDateArray = []
        var dateObj = {}

        var venue_name = $('#venue_name').val()
        dateObj.venue_name = venue_name;


        //get disabled dates
        $.ajax({
            type: 'POST',
            url: '/getBlockedDates',
            dataType: 'json',
            data: JSON.stringify(dateObj),
            contentType: 'application/json',
            success: function (response) {
                var dateResponse = response.datesArray
                for (var i = 0; i < dateResponse.length; i++) {
                    disabledDateArray.push(dateResponse[i])
                }

                paidDatesAjax()
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect.\n Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found. [404]');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error [500].');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error.\n' + jqXHR.responseText);
                }
            }
        })



        /* $(document).ajaxSend(function () {
             $("#overlay").fadeIn(300);
         });*/


        //get paid dates
        function paidDatesAjax() {
            dateObj.dateArray = disabledDateArray
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: '/validateDate',
                contentType: 'application/json',
                data: JSON.stringify(dateObj),
                success: function (response) {
                    var dateResponse1 = response.blockedDatesArray
                    for (var i = 0; i < dateResponse1.length; i++) {
                        disabledDateArray.push(dateResponse1[i])
                    }
                    $('#datetimepicker').datepicker('setDatesDisabled', disabledDateArray)


                    /*if (dateResponse == "true") {
                        alert("No Bookings available on the selected date. Please select another date")
                        $('#enquiry').prop('disabled', true)
                        disableSubmit = true
                        return false;
                    }
                    else {
                        $('#enquiry').prop('disabled', false)
                    }*/

                },
                error: function (jqXHR, exception) {
                    if (jqXHR.status === 0) {
                        alert('Not connect.\n Verify Network.');
                    } else if (jqXHR.status == 404) {
                        alert('Requested page not found. [404]');
                    } else if (jqXHR.status == 500) {
                        alert('Internal Server Error [500].');
                    } else if (exception === 'parsererror') {
                        alert('Requested JSON parse failed.');
                    } else if (exception === 'timeout') {
                        alert('Time out error.');
                    } else if (exception === 'abort') {
                        alert('Ajax request aborted.');
                    } else {
                        alert('Uncaught Error.\n' + jqXHR.responseText);
                    }
                },
            });
        }


        $('#datetimepicker').datepicker({

            format: 'dd/mm/yyyy',
            startDate: new Date(),
            endDate: new Date(new Date().setDate(new Date().getDate() + 60)),
        }).on('changeDate show', function (selected) {
            $('#feedbackform').bootstrapValidator('revalidateField', 'booking_date');


        });

        /*  $(document).on('change', "#datetimepicker", function () {
              //var requestedDate = $('#booking_date').val()
              //if (requestedDate != '') {
              //dateObj.requested_date = requestedDate;
              $.ajax({
                  type: 'GET',
                  success: function (data) {
                      console.log(data);
                  }
              }).done(function () {
  
                  setTimeout(function () {
  
                      $("#overlay").fadeOut(300);
  
                  }, 1000);
  
              });
              //}
          });*/


        $('#feedbackform').bootstrapValidator({
            // To use feedback icons, ensure that you use Bootstrap v3.1.0 or later
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                first_name: {
                    validators: {
                        notEmpty: {
                            message: 'Name cannot be empty'
                        }
                    },
                },
                occasion_type: {
                    validators: {
                        notEmpty: {
                            message: 'Occastion Type field cannot be empty'
                        }
                    }
                },
                booking_date: {
                    validators: {
                        notEmpty: {
                            message: 'Booking Date field cannot be empty'
                        }
                    }
                },
                email: {
                    validators: {
                        emailAddress: {
                            message: 'Please supply a valid email address'
                        },
                        notEmpty: {
                            message: 'Email Address field cannot be empty'
                        }
                    }
                },
                aadhar: {
                    validators: {
                        notEmpty: {
                            message: "Aadhar Number field cannot be empty"
                        },
                        stringLength: {
                            max: 12,
                        }
                    }
                },
                pan: {
                    validators: {
                        notEmpty: {
                            message: "Pan Number field cannot be empty"
                        },
                        stringLength: {
                            max: 10
                        }

                    }
                },
                billing_address: {
                    validators: {
                        notEmpty: {
                            message: "Billing Address field cannot be empty"
                        }
                    }
                }

            },
            submitHandler: function (validator, form, submitButton) {
                alert("Your Feedback has been successfully submitted!!");
                validator.defaultSubmit();

            }
        })
    })
    /*$(document).ready(function () {
        $('#datetimepicker').datepicker({
            startDate: new Date(),
            endDate: new Date(new Date().setDate(new Date().getDate() + 60))
        });

        $(document).on('change', "#datetimepicker", function () {

        })

    })*/


</script>

</html>